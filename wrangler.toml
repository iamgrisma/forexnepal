# Cloudflare Workers configuration for forexnepal.com
name = "forexnepal"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

# D1 Database binding
[[d1_databases]]
binding = "FOREX_DB"
database_name = "forex-rates"
database_id = "05ede330-5c35-4aee-8843-6c3527817925" # Replace with your actual D1 database ID

# KV namespace for static assets
[[kv_namespaces]]
binding = "__STATIC_CONTENT"
id = "d23853432a9d4f09955d9aa93e8dcca8"

# KV namespace for API settings cache
[[kv_namespaces]]
binding = "API_SETTINGS_CACHE"
id = "6eae569e69a748478ddef2014ee60022"

[triggers]
crons = ["15 18 * * *", "35 18 * * *", "15 23 * * *"]

[site]
bucket = "./dist"

[build]
command = "npm run build"

[build.upload]
format = "service-worker"
# JWT_SECRET should be set as a Cloudflare secret
# Use: wrangler secret put JWT_SECRET
