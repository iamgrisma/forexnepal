# Cloudflare Workers configuration for forexnepal.com
name = "forexnepal"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

# D1 Database binding
[[d1_databases]]
binding = "FOREX_DB"
database_name = "forex-rates"
database_id = "05ede330-5c35-4aee-8843-6c3527817925" # Replace with your actual D1 database ID

# KV namespace for static assets
[[kv_namespaces]]
binding = "__STATIC_CONTENT"
id = "4832be13ba554d09a34e4890957d78e5" # Replace with your actual KV namespace ID

# --- NEW: KV namespace for API settings cache ---
[[kv_namespaces]]
binding = "API_SETTINGS_CACHE"
id = "aaccf23c215949aea14b2cd7bcc8ccca" # Create this in Cloudflare and paste its ID here

# Multiple cron schedules for database updates (Nepal Time = UTC+5:45)
# 12:00 AM NPT = 6:15 PM UTC (18:15 UTC)
# 12:20 AM NPT = 6:35 PM UTC (18:35 UTC)
# 5:00 AM NPT = 11:15 PM UTC (23:15 UTC)
[triggers]
crons = ["15 18 * * *", "35 18 * * *", "15 23 * * *"]

[site]
bucket = "./dist"

[build]
command = "npm run build"

[build.upload]
format = "service-worker"
